<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UML Diagrams - Hotel Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #3889af 0%, #f5a9dc 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0);
            padding: 15px 20px;
            margin-bottom: 30px;
        }
        
        .navbar-brand {
            color: white !important;
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
        }
        
        .navbar-nav {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 25px;
            margin-left: auto;
        }

        .navbar-nav .nav-link {
            color: white;
            font-weight: 500;
            transition: color 0.3s ease;
            text-decoration: none;
        }
        
        .navbar-nav .nav-link:hover {
            color: #f8f9fa;
            text-decoration: none;
        }
        
        .navbar-nav .nav-link.active {
            color: #ffd700;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .page-header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .diagram-card {
            background: white;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .diagram-header {
            background: linear-gradient(135deg, #420017 0%, #ff9dcc 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .diagram-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }
        
        .diagram-content {
            padding: 30px;
        }
        
        .diagram-description {
            margin-bottom: 20px;
            color: #666;
            line-height: 1.6;
        }
        
        .puml-code {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .copy-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            margin-top: 10px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .copy-btn:hover {
            background: #0056b3;
        }
        
        .diagram-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
        }
        
        .activity-diagram {
            border-left: 4px solid #28a745;
        }
        
        .class-diagram {
            border-left: 4px solid #007bff;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .feature-list li i {
            color: #28a745;
            margin-right: 10px;
            width: 20px;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">Hotel Manager</a>
            <div class="navbar-nav">
                <a class="nav-link" href="/">Home</a>
                <a class="nav-link" href="/rooms">Rooms</a>
                <a class="nav-link" href="/reservations">Reservations</a>
                <a class="nav-link" href="/customers">Customers</a>
                <a class="nav-link active" href="/uml">UML</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Page Header -->
        <div class="page-header">
            <h1><i class="fas fa-project-diagram me-3"></i>UML Diagrams</h1>
            <p class="lead">Hotel Management System - UML Documentation</p>
            <div class="row text-start mt-4">
                <div class="col-md-6">
                    <h5><i class="fas fa-sitemap me-2"></i>Class Diagram</h5>
                    <ul class="feature-list">
                        <li><i class="fas fa-check"></i>Complete system architecture</li>
                        <li><i class="fas fa-check"></i>Entity relationships</li>
                        <li><i class="fas fa-check"></i>Service layer structure</li>
                        <li><i class="fas fa-check"></i>Controller mappings</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5><i class="fas fa-play-circle me-2"></i>Activity Diagrams</h5>
                    <ul class="feature-list">
                        <li><i class="fas fa-check"></i>Customer management workflow</li>
                        <li><i class="fas fa-check"></i>Room booking process</li>
                        <li><i class="fas fa-check"></i>Room management operations</li>
                        <li><i class="fas fa-check"></i>Availability checking logic</li>
                        <li><i class="fas fa-check"></i>Price calculation process</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Class Diagram Section -->
        <div class="diagram-card class-diagram">
            <div class="diagram-header">
                <i class="fas fa-sitemap fa-2x"></i>
                <div>
                    <h3>Hotel Management System - Class Diagram</h3>
                    <p class="mb-0">Complete system architecture with all entities, services, and controllers</p>
                </div>
            </div>
            <div class="diagram-content">
                <div class="diagram-description">
                    <strong>Main Features:</strong> This class diagram shows the complete structure of the Hotel Management System including:
                    Entity models (Room, Customer, Reservation), Repository interfaces, Service classes, Controller classes, and their relationships.
                </div>
                <div class="puml-code" id="class-diagram-code">
@startuml Hotel Management System - Detailed Architecture
!theme materia-outline
title Hotel Management System - Main UML

' Unified left-to-right layout
left to right direction
skinparam ranksep 40
skinparam nodesep 15

' Global styling
skinparam backgroundColor #FFFFFF
skinparam shadowing true
skinparam roundCorner 14
skinparam linetype ortho
skinparam packageStyle rectangle
skinparam defaultFontSize 15
skinparam ArrowColor #455A64
skinparam ArrowThickness 2

skinparam class {
  BackgroundColor #F8FAFF
  BorderColor #1A4E89
  ArrowColor #1A4E89
  FontSize 15
  AttributeFontSize 14
  BorderThickness 5
}

' Package definitions
package "Model Layer" {
  class Room {
    - id: Long
    - roomId: String
    - type: RoomType
    - price: Double
    - isAvailable: Boolean
    - description: String
    --
    + addReservation(reservation: Reservation): void
    + isAvailableForPeriod(checkIn: LocalDate, checkOut: LocalDate): boolean
  }

  class Customer {
    - id: Long
    - fullName: String
    - email: String
    - phone: String
    - idNumber: String
    --
    + getTotalReservations(): int
  }

  class Reservation {
    - id: Long
    - checkInDate: LocalDate
    - checkOutDate: LocalDate
    - totalPrice: Double
    --
    + calculateTotalPrice(): Double
    + getDurationInDays(): long
  }
}

package "Repository Layer" {
    interface RoomRepository {
        + findAll(): List<Room>
        + findById(id: Long): Optional<Room>
        + save(room: Room): Room
        + deleteById(id: Long): void
        + findByRoomId(roomId: String): Optional<Room>
    }
    
    interface ReservationRepository {
        + findAll(): List<Reservation>
        + findById(id: Long): Optional<Reservation>
        + save(reservation: Reservation): Reservation
        + deleteById(id: Long): void
    }
    
    interface CustomerRepository {
        + findAll(): List<Customer>
        + findById(id: Long): Optional<Customer>
        + save(customer: Customer): Customer
        + deleteById(id: Long): void
        + findByEmail(email: String): Optional<Customer>
    }
}

package "Service Layer" {
    class RoomService {
        - roomRepository: RoomRepository
        --
        + findAllRooms(): List<Room>
        + saveRoom(room: Room): Room
        + findRoomById(id: Long): Optional<Room>
        + deleteRoom(id: Long): void
    }
    
    class ReservationService {
        - reservationRepository: ReservationRepository
        --
        + findAllReservations(): List<Reservation>
        + saveReservation(reservation: Reservation): Reservation
        + deleteReservation(id: Long): void
    }
    
    class CustomerService {
        - customerRepository: CustomerRepository
        --
        + findAllCustomers(): List<Customer>
        + saveCustomer(customer: Customer): Customer
        + findCustomerById(id: Long): Optional<Customer>
        + deleteCustomer(id: Long): void
    }
}

package "Controller Layer" {
    class RoomController {
        - roomService: RoomService
        --
        + listRooms(model: Model): String
        + saveRoom(room: Room): String
        + editRoom(id: Long): String
        + deleteRoom(id: Long): String
    }
    
    class ReservationController {
        - reservationService: ReservationService
        - roomService: RoomService
        - customerService: CustomerService
        --
        + listReservations(model: Model): String
        + saveReservation(reservation: Reservation): String
        + deleteReservation(id: Long): String
    }
    
    class CustomerController {
        - customerService: CustomerService
        --
        + listCustomers(model: Model): String
        + saveCustomer(customer: Customer): String
        + editCustomer(id: Long): String
        + deleteCustomer(id: Long): String
    }
}

' Relationships
Room ||--o{ Reservation : "room (OneToMany)"
Customer ||--o{ Reservation : "customer (OneToMany)"

RoomRepository ..> Room : "CRUD Operations"
ReservationRepository ..> Reservation : "CRUD Operations"
CustomerRepository ..> Customer : "CRUD Operations"

RoomService --> RoomRepository : "Data Access"
ReservationService --> ReservationRepository : "Data Access"
CustomerService --> CustomerRepository : "Data Access"

RoomController --> RoomService : "Business Logic"
ReservationController --> ReservationService : "Primary Service"
ReservationController --> RoomService : "Room Selection"
ReservationController --> CustomerService : "Customer Management"
CustomerController --> CustomerService : "Business Logic"

@enduml
                </div>
                <button class="copy-btn" onclick="copyToClipboard('class-diagram-code')">
                    <i class="fas fa-copy me-2"></i>Copy PlantUML Code
                </button>
            </div>
        </div>

        <!-- Activity Diagrams Section -->
        <div class="row">
            <div class="col-12">
                <h2 class="text-white mb-4"><i class="fas fa-play-circle me-3"></i>Activity Diagrams</h2>
            </div>
        </div>

        <div class="diagram-grid">
            <!-- Customer Management Activity -->
            <div class="diagram-card activity-diagram">
                <div class="diagram-header" style="background: linear-gradient(135deg, #00684a 0%, #00b894 100%);">
                    <i class="fas fa-users fa-2x"></i>
                    <div>
                        <h3>Customer Management</h3>
                        <p class="mb-0">CRUD operations workflow</p>
                    </div>
                </div>
                <div class="diagram-content">
                    <div class="diagram-description">
                        <strong>Process:</strong> Complete customer management workflow including add, edit, delete, and search functionality 
                        based on CustomerController and CustomerService classes.
                    </div>
                    <div class="puml-code" id="customer-diagram-code">
@startuml Customer Management Activity Diagram
!theme plain
title Customer Management Process

start
:User accesses /customers endpoint;
:CustomerController.listCustomers() called;

if (Search parameter provided?) then (yes)
    :CustomerService.searchCustomers() called;
    :Display filtered customer list;
else (no)
    :CustomerService.findAllCustomers() called;
    :Display all customers;
endif

:Show customers page with form;

if (User action?) then (Add New Customer)
    :User fills customer details;
    :CustomerController.saveCustomer() called;
    :CustomerService.validateCustomer() executed;
    
    if (Validation passed?) then (yes)
        :CustomerRepository.save() called;
        :Success message added;
        :Redirect to /customers;
    else (no)
        :Add validation error message;
        :Redirect to /customers;
    endif
    
elseif (Edit Customer) then
    :CustomerController.editCustomer() called;
    :CustomerService.updateCustomer() called;
    
elseif (Delete Customer) then
    :CustomerController.deleteCustomer() called;
    :CustomerService.deleteCustomer() called;
endif

stop
@enduml
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('customer-diagram-code')">
                        <i class="fas fa-copy me-2"></i>Copy PlantUML Code
                    </button>
                </div>
            </div>

            <!-- Room Management Activity -->
            <div class="diagram-card activity-diagram">
                <div class="diagram-header" style="background: linear-gradient(135deg, #ce8a0b 0%, #e17055 100%);">
                    <i class="fas fa-bed fa-2x"></i>
                    <div>
                        <h3>Room Management</h3>
                        <p class="mb-0">Room CRUD operations</p>
                    </div>
                </div>
                <div class="diagram-content">
                    <div class="diagram-description">
                        <strong>Process:</strong> Room management workflow with validation, CRUD operations, 
                        and error handling based on RoomController and RoomService.
                    </div>
                    <div class="puml-code" id="room-diagram-code">
@startuml Room Management Process
!theme plain
title Room Management Process

start
:User accesses /rooms endpoint;
:RoomController.listRooms() called;
:Display rooms page with form;

if (User action?) then (Add New Room)
    :User fills room form;
    :RoomController.saveRoom() called;
    :@Valid annotation triggers validation;
    
    if (Validation errors exist?) then (yes)
        :Display form with errors;
    else (no)
        :RoomService.saveRoom() called;
        :Add success flash message;
        :Redirect to /rooms;
    endif
    
elseif (Edit Room) then
    :RoomController.editRoom() called;
    :RoomService.updateRoom() called;
    
else (Delete Room)
    :RoomController.deleteRoom() called;
    :RoomService.deleteRoom() called;
endif

stop
@enduml
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('room-diagram-code')">
                        <i class="fas fa-copy me-2"></i>Copy PlantUML Code
                    </button>
                </div>
            </div>

            <!-- Reservation Booking Activity -->
            <div class="diagram-card activity-diagram">
                <div class="diagram-header" style="background: linear-gradient(135deg, #420017 0%, #ff9dcc 100%);">
                    <i class="fas fa-calendar-check fa-2x"></i>
                    <div>
                        <h3>Reservation Booking</h3>
                        <p class="mb-0">Booking creation process</p>
                    </div>
                </div>
                <div class="diagram-content">
                    <div class="diagram-description">
                        <strong>Process:</strong> Complete reservation booking workflow including room selection, 
                        customer handling, and price calculation.
                    </div>
                    <div class="puml-code" id="booking-diagram-code">
@startuml Reservation Booking Process
!theme plain
title Reservation Booking Process

start
:User accesses /reservations endpoint;
:ReservationController.listReservations() called;
:Display reservations page with booking form;

:User fills reservation details;
:ReservationController.saveReservation() called;

:Get room by roomId;
if (Room found?) then (yes)
    if (Existing customer selected?) then (yes)
        :Set existing customer to reservation;
    else (no)
        :Create new customer if info provided;
    endif
    
    :reservation.calculateTotalPrice() called;
    :ReservationService.saveReservation() called;
    :Add success message;
    :Redirect to /reservations;
else (no)
    :Add "Room not found" error;
    :Redirect to /reservations;
endif

stop
@enduml
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('booking-diagram-code')">
                        <i class="fas fa-copy me-2"></i>Copy PlantUML Code
                    </button>
                </div>
            </div>

            <!-- Room Availability Check -->
            <div class="diagram-card activity-diagram">
                <div class="diagram-header" style="background: linear-gradient(135deg, #1565C0 0%, #42A5F5 100%);">
                    <i class="fas fa-search fa-2x"></i>
                    <div>
                        <h3>Room Availability Check</h3>
                        <p class="mb-0">Availability validation logic</p>
                    </div>
                </div>
                <div class="diagram-content">
                    <div class="diagram-description">
                        <strong>Process:</strong> Room availability checking algorithm using 
                        Room.isAvailableForPeriod() method with date overlap detection.
                    </div>
                    <div class="puml-code" id="availability-diagram-code">
@startuml Room Availability Check Process
!theme plain
title Room Availability Check Process

start
:User requests room availability check;
:Room.isAvailableForPeriod() method called;
:Get all reservations for this room;

partition "For each reservation" {
    :Get reservation dates;
    :Check date overlap;
    if (Dates overlap?) then (yes)
        :Room is NOT available;
        :Return false;
        stop
    else (no)
        :Continue checking;
    endif
}

:All reservations checked;
:Room IS available for period;
:Return true;
stop
@enduml
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('availability-diagram-code')">
                        <i class="fas fa-copy me-2"></i>Copy PlantUML Code
                    </button>
                </div>
            </div>

            <!-- Price Calculation -->
            <div class="diagram-card activity-diagram">
                <div class="diagram-header" style="background: linear-gradient(135deg, #7B1FA2 0%, #BA68C8 100%);">
                    <i class="fas fa-calculator fa-2x"></i>
                    <div>
                        <h3>Price Calculation</h3>
                        <p class="mb-0">Total price computation</p>
                    </div>
                </div>
                <div class="diagram-content">
                    <div class="diagram-description">
                        <strong>Process:</strong> Reservation price calculation using 
                        Reservation.calculateTotalPrice() method with ChronoUnit for date calculations.
                    </div>
                    <div class="puml-code" id="price-diagram-code">
@startuml Reservation Price Calculation Process
!theme plain
title Reservation Price Calculation Process

start
:Call reservation.calculateTotalPrice() method;

if (Room is set?) then (yes)
    if (Check-in date is set?) then (yes)
        if (Check-out date is set?) then (yes)
            :Get room price per night;
            :Calculate duration in days;
            :long nights = ChronoUnit.DAYS.between(checkInDate, checkOutDate);
            :Calculate total price;
            :Double totalPrice = roomPrice * nights;
            :Return calculated total price;
        else (no)
            :Return 0.0 as total price;
        endif
    else (no)
        :Return 0.0 as total price;
    endif
else (no)
    :Return 0.0 as total price;
endif

stop
@enduml
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('price-diagram-code')">
                        <i class="fas fa-copy me-2"></i>Copy PlantUML Code
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-5 mb-3">
            <p class="text-white">
                <i class="fas fa-info-circle me-2"></i>
                These UML diagrams are based on the actual source code of the Hotel Management System.
                Use PlantUML to render these diagrams.
            </p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(function() {
                // Show success feedback
                const button = element.nextElementSibling;
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check me-2"></i>Copied!';
                button.style.background = '#28a745';
                
                setTimeout(function() {
                    button.innerHTML = originalText;
                    button.style.background = '#007bff';
                }, 2000);
            }).catch(function(err) {
                console.error('Could not copy text: ', err);
                alert('Failed to copy to clipboard');
            });
        }
    </script>
</body>
</html>
